#INFO: **** input file is /home/jluis/src/git/scripts/chf/test2/chf.py ****
#!/usr/bin/env python

import numpy, sys
from functools import reduce
from pyscf import gto, scf, lo, dft, lib, ao2mo
from pyscf.tools import wfn_format, molden

def get_pop(dm, s, lmultipliers):

    label = mol.spheric_labels(False)

    #pop = numpy.einsum('ij,ji->i', dm,s)
    #chg1 = numpy.zeros(mol.natm)
    #qq1 = numpy.zeros(mol.natm)
    #for i, s1 in enumerate(label):
    #    chg1[s1[0]] += pop[i]
    #for ia in range(mol.natm):
    #    symb = mol.atom_symbol(ia)
    #    qq1[ia] = mol.atom_charge(ia)-chg1[ia]
    #    lib.logger.info(mf, 'Pop, Q, of %d %s = %12.6f %12.6f' \
    #    % (ia+1, symb, chg1[ia], qq1[ia]))

    nao = dm.shape[0]
    fock = numpy.zeros_like(dm)
    for ia in range(mol.natm):
        g = numpy.zeros_like(dm)
        iden = numpy.zeros_like(dm)
        for i, s1 in enumerate(label):
            if (s1[0]==ia):
                iden[i,:] = 1.0
        iden = 0.5*(iden+iden.T)
        #print iden
        #tmp = numpy.einsum('ij,ji->ij',iden,s)
        #tmp = numpy.einsum('ij,ji->',tmp,dm)
        #lib.logger.info(mf, 'Pop of %d = %12.6f' % (ia+1, tmp))
        g = numpy.einsum('ij,ji->ij', iden,s)
        fock += lmultipliers[ia]*g

    return fock

def get_cfock(h1e, s1e, vhf, dm, cycle=0, mf_diis=None):
    fock = old_get_fock(h1e, s1e, vhf, dm, cycle, mf_diis)
    fock -= get_pop(dm, s1e, multiplicadores) 
    return fock

mol = gto.Mole()
mol.verbose = 4
mol.atom = '''
Li  0.000000000000000  0.000000000000000  0.000000000000000
F   0.000000000000000  0.000000000000000  1.563900000000000
'''
mol.basis = '6-31g'
mol.spin = 0
mol.charge = 0
mol.symmetry = 0
mol.build()

mf = scf.RHF(mol)
mf.verbose = 0
mf.kernel()
dm = mf.make_rdm1()

multiplicadores = numpy.zeros(mol.natm)

my_diis_obj = scf.ADIIS()
my_diis_obj.diis_space = 14

x = [-0.1, -0.2, -0.3, -0.4, -0.5, -0.6, -0.7, -0.8, -0.9, -1.0, 0.0,
0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
x = numpy.asarray(x)
ehf = []

#for b in x:
#    multiplicadores = [0.0,b]

multiplicadores = [0.15,0.00]
mf = scf.RHF(mol)
mf.conv_tol = 1e-6
mf.max_cycle = 120
mf.diis = my_diis_obj
old_get_fock = mf.get_fock
mf.get_fock = get_cfock 
#mf.verbose = 3
ehf.append(mf.kernel(dm0=dm))
mf.analyze(with_meta_lowdin=False)
dm = mf.make_rdm1()

name = 'lif_-0p6'    
wfn_file = name + '.wfn'
with open(wfn_file, 'w') as f2:
    wfn_format.write_mo(f2, mol, mf.mo_coeff[:,mf.mo_occ>0], \
    mo_occ=mf.mo_occ[mf.mo_occ>0], mo_energy=mf.mo_energy[mf.mo_occ>0])

#INFO: ******************** input file end ********************


System: ('Linux', 'silicio', '3.16.0-4-amd64', '#1 SMP Debian 3.16.51-3 (2017-12-13)', 'x86_64', '')  Threads 12
Python 2.7.15 (default, Oct 25 2018, 01:35:55) 
[GCC 8.2.0]
numpy 1.15.3  scipy 1.1.0
Date: Thu Nov  1 03:55:42 2018
PySCF version 1.6a
PySCF path  /home/jluis/src/pyscf/dev/pyscf
GIT ORIG_HEAD 090d7a77795211ecfcdfc6ced606736fde25d1c7
GIT HEAD      ref: refs/heads/dev
GIT dev branch  27eb228cd9fdd7aebc89cf429224ff485f9c21c4

[ENV] PYSCF_TMPDIR /scratch-ssd/jluis
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 Li     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 F      0.000000000000   0.000000000000   1.563900000000 AA    0.000000000000   0.000000000000   2.955342686207 Bohr

nuclear repulsion = 9.13599635196624
number of shells = 10
number of NR pGTOs = 44
number of NR cGTOs = 18
basis = 6-31g
ecp = {}
CPU time:         0.34


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <pyscf.scf.diis.ADIIS object at 0x2b2ee827f750>
DIIS start cycle = 1
DIIS space = 6
SCF tol = 1e-06
SCF gradient tol = None
max. SCF cycles = 120
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch-ssd/jluis/tmpO5EWQI
max_memory 4000 MB (current use 70 MB)
Set gradient conv threshold to 0.001
init E= -106.920889785846
  HOMO = -0.461201982394675  LUMO = -0.145860811679923
cycle= 1 E= -106.897123213645  delta_E= 0.0238  |g|= 0.124  |ddm|= 0.541
  HOMO = -0.541589271082587  LUMO = -0.141149654669675
cycle= 2 E= -106.901994911163  delta_E= -0.00487  |g|= 0.0819  |ddm|= 0.11
  HOMO = -0.497053635093303  LUMO = -0.14139682109272
cycle= 3 E= -106.892857642603  delta_E= 0.00914  |g|= 0.0755  |ddm|= 0.113
  HOMO = -0.497053635093303  LUMO = -0.14139682109272
cycle= 4 E= -106.892857642603  delta_E=    0  |g|= 0.0755  |ddm|= 1.56e-31
  HOMO = -0.497053635093303  LUMO = -0.14139682109272
cycle= 5 E= -106.892857642603  delta_E=    0  |g|= 0.0755  |ddm|= 1.56e-31
  HOMO = -0.497053635093303  LUMO = -0.14139682109272
cycle= 6 E= -106.892857642603  delta_E=    0  |g|= 0.0755  |ddm|=    0
  HOMO = -0.497053635093302  LUMO = -0.141396821092721
cycle= 7 E= -106.892857642603  delta_E= 2.84e-14  |g|= 0.0755  |ddm|= 2.45e-14
  HOMO = -0.497053635093302  LUMO = -0.141396821092721
cycle= 8 E= -106.892857642603  delta_E=    0  |g|= 0.0755  |ddm|= 1.22e-14
  HOMO = -0.539763616678856  LUMO = -0.140217772081751
cycle= 9 E= -106.900337868067  delta_E= -0.00748  |g|= 0.0647  |ddm|= 0.0972
  HOMO = -0.503027947282053  LUMO = -0.14100106387811
cycle= 10 E= -106.893993612139  delta_E= 0.00634  |g|= 0.0569  |ddm|= 0.0827
  HOMO = -0.503027947282054  LUMO = -0.141001063878109
cycle= 11 E= -106.893993612139  delta_E= -2.84e-14  |g|= 0.0569  |ddm|= 1.36e-14
  HOMO = -0.503027947282055  LUMO = -0.141001063878112
cycle= 12 E= -106.893993612139  delta_E= 9.95e-14  |g|= 0.0569  |ddm|= 1.56e-14
  HOMO = -0.503027947282053  LUMO = -0.141001063878111
cycle= 13 E= -106.893993612139  delta_E= -1.42e-13  |g|= 0.0569  |ddm|= 3.02e-14
  HOMO = -0.503027947282053  LUMO = -0.141001063878112
cycle= 14 E= -106.893993612139  delta_E= 1.42e-14  |g|= 0.0569  |ddm|= 1.08e-14
  HOMO = -0.503027947282053  LUMO = -0.141001063878111
cycle= 15 E= -106.893993612139  delta_E=    0  |g|= 0.0569  |ddm|= 1.21e-14
  HOMO = -0.535112039285435  LUMO = -0.140235991272712
cycle= 16 E= -106.899787152945  delta_E= -0.00579  |g|= 0.0495  |ddm|= 0.0734
  HOMO = -0.507031028913953  LUMO = -0.140875946166396
cycle= 17 E= -106.894948549797  delta_E= 0.00484  |g|= 0.0434  |ddm|= 0.0635
  HOMO = -0.507031028913953  LUMO = -0.140875946166396
cycle= 18 E= -106.894948549797  delta_E=    0  |g|= 0.0434  |ddm|=    0
  HOMO = -0.507031028913953  LUMO = -0.140875946166396
cycle= 19 E= -106.894948549797  delta_E=    0  |g|= 0.0434  |ddm|= 8.14e-15
  HOMO = -0.507031028913953  LUMO = -0.140875946166396
cycle= 20 E= -106.894948549797  delta_E= -2.84e-14  |g|= 0.0434  |ddm|= 1.09e-14
  HOMO = -0.507031028913953  LUMO = -0.140875946166394
cycle= 21 E= -106.894948549797  delta_E= 2.84e-14  |g|= 0.0434  |ddm|= 1.68e-14
  HOMO = -0.507031028913953  LUMO = -0.140875946166396
cycle= 22 E= -106.894948549797  delta_E=    0  |g|= 0.0434  |ddm|= 1.75e-14
  HOMO = -0.531496970608287  LUMO = -0.140306175485297
cycle= 23 E= -106.899347464731  delta_E= -0.0044  |g|= 0.0378  |ddm|= 0.0557
  HOMO = -0.510084850156905  LUMO = -0.140800060709602
cycle= 24 E= -106.895642633286  delta_E= 0.0037  |g|= 0.0331  |ddm|= 0.0485
  HOMO = -0.510084850156905  LUMO = -0.140800060709602
cycle= 25 E= -106.895642633286  delta_E=    0  |g|= 0.0331  |ddm|= 7.99e-15
  HOMO = -0.510084850156906  LUMO = -0.140800060709605
cycle= 26 E= -106.895642633286  delta_E=    0  |g|= 0.0331  |ddm|= 9.8e-15
  HOMO = -0.510084850156904  LUMO = -0.140800060709605
cycle= 27 E= -106.895642633286  delta_E= 8.53e-14  |g|= 0.0331  |ddm|= 2.04e-14
  HOMO = -0.510084850156904  LUMO = -0.140800060709604
cycle= 28 E= -106.895642633286  delta_E= -1.14e-13  |g|= 0.0331  |ddm|= 1.17e-14
  HOMO = -0.510084850156905  LUMO = -0.140800060709602
cycle= 29 E= -106.895642633286  delta_E= 2.84e-14  |g|= 0.0331  |ddm|= 1.67e-14
  HOMO = -0.528747622362765  LUMO = -0.140367781152722
cycle= 30 E= -106.898981759753  delta_E= -0.00334  |g|= 0.0288  |ddm|= 0.0424
  HOMO = -0.51242337175519  LUMO = -0.140745382070999
cycle= 31 E= -106.896146553711  delta_E= 0.00284  |g|= 0.0252  |ddm|= 0.037
  HOMO = -0.512423371755191  LUMO = -0.140745382070999
cycle= 32 E= -106.896146553711  delta_E= 1.42e-14  |g|= 0.0252  |ddm|= 8.89e-15
  HOMO = -0.512423371755192  LUMO = -0.140745382071003
cycle= 33 E= -106.896146553711  delta_E= 2.84e-14  |g|= 0.0252  |ddm|= 2.05e-14
  HOMO = -0.512423371755197  LUMO = -0.140745382071001
cycle= 34 E= -106.896146553711  delta_E= -2.84e-14  |g|= 0.0252  |ddm|= 3.3e-14
  HOMO = -0.512423371755191  LUMO = -0.140745382071
cycle= 35 E= -106.896146553711  delta_E= 5.68e-14  |g|= 0.0252  |ddm|= 1.57e-14
  HOMO = -0.51242337175519  LUMO = -0.140745382070999
cycle= 36 E= -106.896146553711  delta_E= -8.53e-14  |g|= 0.0252  |ddm|= 1.77e-14
  HOMO = -0.526656926860581  LUMO = -0.14041612214597
cycle= 37 E= -106.898683280265  delta_E= -0.00254  |g|= 0.022  |ddm|= 0.0324
  HOMO = -0.514212337118907  LUMO = -0.140704168068559
cycle= 38 E= -106.896515293993  delta_E= 0.00217  |g|= 0.0192  |ddm|= 0.0282
  HOMO = -0.514212337118906  LUMO = -0.140704168068558
cycle= 39 E= -106.896515293993  delta_E= -9.95e-14  |g|= 0.0192  |ddm|= 3.97e-14
  HOMO = -0.514212337118907  LUMO = -0.140704168068559
cycle= 40 E= -106.896515293993  delta_E=    0  |g|= 0.0192  |ddm|= 2.01e-14
  HOMO = -0.51421233711892  LUMO = -0.14070416806856
cycle= 41 E= -106.896515293993  delta_E= 5.68e-14  |g|= 0.0192  |ddm|= 3.55e-14
  HOMO = -0.51421233711891  LUMO = -0.14070416806856
cycle= 42 E= -106.896515293993  delta_E= 5.68e-14  |g|= 0.0192  |ddm|= 2.19e-14
  HOMO = -0.51421233711891  LUMO = -0.14070416806856
cycle= 43 E= -106.896515293993  delta_E= -4.26e-14  |g|= 0.0192  |ddm|= 2.73e-14
  HOMO = -0.525066400140519  LUMO = -0.140453144050672
cycle= 44 E= -106.898443941635  delta_E= -0.00193  |g|= 0.0168  |ddm|= 0.0247
  HOMO = -0.515579677614726  LUMO = -0.140672745100385
cycle= 45 E= -106.896787293684  delta_E= 0.00166  |g|= 0.0147  |ddm|= 0.0215
  HOMO = -0.515579677614717  LUMO = -0.140672745100386
cycle= 46 E= -106.896787293684  delta_E= 1.42e-14  |g|= 0.0147  |ddm|= 2.67e-14
  HOMO = -0.515579677614724  LUMO = -0.140672745100385
cycle= 47 E= -106.896787293684  delta_E= 7.11e-14  |g|= 0.0147  |ddm|= 2.12e-14
  HOMO = -0.51557967761473  LUMO = -0.140672745100388
cycle= 48 E= -106.896787293684  delta_E= -1.42e-14  |g|= 0.0147  |ddm|= 2.65e-14
  HOMO = -0.515579677614719  LUMO = -0.140672745100385
cycle= 49 E= -106.896787293684  delta_E= -7.11e-14  |g|= 0.0147  |ddm|= 3.1e-14
  HOMO = -0.515579677614722  LUMO = -0.140672745100385
cycle= 50 E= -106.896787293684  delta_E= 1.42e-14  |g|= 0.0147  |ddm|= 2.6e-14
  HOMO = -0.523855911795543  LUMO = -0.140481333261236
cycle= 51 E= -106.898254551108  delta_E= -0.00147  |g|= 0.0128  |ddm|= 0.0188
  HOMO = -0.516624077439251  LUMO = -0.140648729051953
cycle= 52 E= -106.896989329027  delta_E= 0.00127  |g|= 0.0112  |ddm|= 0.0164
  HOMO = -0.516624077439251  LUMO = -0.140648729051954
cycle= 53 E= -106.896989329027  delta_E= -1.42e-14  |g|= 0.0112  |ddm|= 2.07e-14
  HOMO = -0.516624077439251  LUMO = -0.140648729051953
cycle= 54 E= -106.896989329027  delta_E= 1.42e-14  |g|= 0.0112  |ddm|= 2.07e-14
  HOMO = -0.516624077439251  LUMO = -0.140648729051954
cycle= 55 E= -106.896989329027  delta_E= -1.42e-14  |g|= 0.0112  |ddm|= 1.98e-14
  HOMO = -0.51662407743925  LUMO = -0.140648729051955
cycle= 56 E= -106.896989329027  delta_E= 1.14e-13  |g|= 0.0112  |ddm|= 2.44e-14
  HOMO = -0.516624077439252  LUMO = -0.140648729051955
cycle= 57 E= -106.896989329027  delta_E= -1.71e-13  |g|= 0.0112  |ddm|= 1.26e-14
  HOMO = -0.522934342771014  LUMO = -0.1405027738395
cycle= 58 E= -106.898106122607  delta_E= -0.00112  |g|= 0.00975  |ddm|= 0.0143
  HOMO = -0.517421423755744  LUMO = -0.140630372398039
cycle= 59 E= -106.897140250866  delta_E= 0.000966  |g|= 0.00851  |ddm|= 0.0125
  HOMO = -0.517421423755749  LUMO = -0.140630372398039
cycle= 60 E= -106.897140250866  delta_E= 1.42e-13  |g|= 0.00851  |ddm|= 1.65e-14
  HOMO = -0.517421423755752  LUMO = -0.140630372398039
cycle= 61 E= -106.897140250866  delta_E= -9.95e-14  |g|= 0.00851  |ddm|= 1.34e-14
  HOMO = -0.51742142375577  LUMO = -0.140630372398038
cycle= 62 E= -106.897140250866  delta_E= 8.53e-14  |g|= 0.00851  |ddm|= 6.19e-14
  HOMO = -0.517421423755748  LUMO = -0.140630372398039
cycle= 63 E= -106.897140250866  delta_E= -4.26e-14  |g|= 0.00851  |ddm|= 5.04e-14
  HOMO = -0.517421423755746  LUMO = -0.140630372398041
cycle= 64 E= -106.897140250866  delta_E= -2.84e-14  |g|= 0.00851  |ddm|= 2.79e-14
  HOMO = -0.522232532701044  LUMO = -0.140519083444347
cycle= 65 E= -106.897990611298  delta_E= -0.00085  |g|= 0.00743  |ddm|= 0.0109
  HOMO = -0.518029939062978  LUMO = -0.140616347524997
cycle= 66 E= -106.89725350357  delta_E= 0.000737  |g|= 0.00649  |ddm|= 0.00954
  HOMO = -0.518029939062974  LUMO = -0.140616347524998
cycle= 67 E= -106.89725350357  delta_E= 8.53e-14  |g|= 0.00649  |ddm|= 2.36e-14
  HOMO = -0.518029939062971  LUMO = -0.140616347524998
cycle= 68 E= -106.89725350357  delta_E= -4.26e-14  |g|= 0.00649  |ddm|= 1.45e-14
  HOMO = -0.518029939062985  LUMO = -0.140616347524997
cycle= 69 E= -106.89725350357  delta_E= 7.11e-14  |g|= 0.00649  |ddm|= 3.28e-14
  HOMO = -0.518029939062975  LUMO = -0.140616347524999
cycle= 70 E= -106.89725350357  delta_E= -9.95e-14  |g|= 0.00649  |ddm|= 2.91e-14
  HOMO = -0.518029939062971  LUMO = -0.140616347524998
cycle= 71 E= -106.89725350357  delta_E= 2.84e-14  |g|= 0.00649  |ddm|= 1.91e-14
  HOMO = -0.521697952271522  LUMO = -0.140531494665911
cycle= 72 E= -106.897901179976  delta_E= -0.000648  |g|= 0.00567  |ddm|= 0.00833
  HOMO = -0.518494219164424  LUMO = -0.140605637237666
cycle= 73 E= -106.897338794073  delta_E= 0.000562  |g|= 0.00495  |ddm|= 0.00727
  HOMO = -0.51849421916434  LUMO = -0.140605637237665
cycle= 74 E= -106.897338794073  delta_E= 8.53e-14  |g|= 0.00495  |ddm|= 1.73e-13
  HOMO = -0.518494219164346  LUMO = -0.140605637237667
cycle= 75 E= -106.897338794073  delta_E= -4.26e-14  |g|= 0.00495  |ddm|= 2.28e-14
  HOMO = -0.518494219164346  LUMO = -0.140605637237668
cycle= 76 E= -106.897338794073  delta_E= 8.53e-14  |g|= 0.00495  |ddm|= 2.69e-14
  HOMO = -0.518494219164342  LUMO = -0.140605637237668
cycle= 77 E= -106.897338794073  delta_E= -2.84e-14  |g|= 0.00495  |ddm|= 4.99e-14
  HOMO = -0.51849421916434  LUMO = -0.140605637237668
cycle= 78 E= -106.897338794073  delta_E= -5.68e-14  |g|= 0.00495  |ddm|= 4.98e-14
  HOMO = -0.52129067718558  LUMO = -0.140540942884456
cycle= 79 E= -106.897832204524  delta_E= -0.000493  |g|= 0.00432  |ddm|= 0.00635
  HOMO = -0.518848381171362  LUMO = -0.140597461420118
cycle= 80 E= -106.897403206448  delta_E= 0.000429  |g|= 0.00377  |ddm|= 0.00555
  HOMO = -0.518848381171363  LUMO = -0.140597461420119
cycle= 81 E= -106.897403206448  delta_E=    0  |g|= 0.00377  |ddm|= 2.31e-14
  HOMO = -0.518848381171383  LUMO = -0.140597461420116
cycle= 82 E= -106.897403206448  delta_E= 2.84e-14  |g|= 0.00377  |ddm|= 7.11e-14
  HOMO = -0.518848381171368  LUMO = -0.140597461420118
cycle= 83 E= -106.897403206448  delta_E= -7.11e-14  |g|= 0.00377  |ddm|= 6.94e-14
  HOMO = -0.518848381171369  LUMO = -0.140597461420116
cycle= 84 E= -106.897403206448  delta_E= 1.42e-14  |g|= 0.00377  |ddm|= 4.34e-14
  HOMO = -0.518848381171362  LUMO = -0.140597461420116
cycle= 85 E= -106.897403206448  delta_E= -2.84e-14  |g|= 0.00377  |ddm|= 2.19e-14
  HOMO = -0.52098034508598  LUMO = -0.140548137770888
cycle= 86 E= -106.897779157402  delta_E= -0.000376  |g|= 0.00329  |ddm|= 0.00484
  HOMO = -0.519118502503869  LUMO = -0.140591222270189
cycle= 87 E= -106.897451957433  delta_E= 0.000327  |g|= 0.00288  |ddm|= 0.00423
  HOMO = -0.519118502503885  LUMO = -0.140591222270188
cycle= 88 E= -106.897451957433  delta_E= -1.42e-14  |g|= 0.00288  |ddm|= 3.83e-14
  HOMO = -0.519118502503901  LUMO = -0.140591222270189
cycle= 89 E= -106.897451957433  delta_E= -5.68e-14  |g|= 0.00288  |ddm|= 4.11e-14
  HOMO = -0.519118502503865  LUMO = -0.140591222270188
cycle= 90 E= -106.897451957433  delta_E= 2.84e-14  |g|= 0.00288  |ddm|= 8.79e-14
  HOMO = -0.519118502504027  LUMO = -0.140591222270185
cycle= 91 E= -106.897451957433  delta_E= -2.84e-14  |g|= 0.00288  |ddm|= 3.72e-13
  HOMO = -0.519118502503865  LUMO = -0.140591222270189
cycle= 92 E= -106.897451957433  delta_E= 5.68e-14  |g|= 0.00288  |ddm|= 3.7e-13
  HOMO = -0.520743853584786  LUMO = -0.140553618124387
cycle= 93 E= -106.897738447354  delta_E= -0.000286  |g|= 0.00251  |ddm|= 0.00369
  HOMO = -0.519324502360886  LUMO = -0.140586462181681
cycle= 94 E= -106.897488917172  delta_E= 0.00025  |g|= 0.00219  |ddm|= 0.00322
  HOMO = -0.519324502360774  LUMO = -0.14058646218168
cycle= 95 E= -106.897488917172  delta_E= -1.42e-13  |g|= 0.00219  |ddm|= 2.53e-13
  HOMO = -0.519324502360782  LUMO = -0.140586462181685
cycle= 96 E= -106.897488917172  delta_E= 1.28e-13  |g|= 0.00219  |ddm|= 4.11e-14
  HOMO = -0.519324502360773  LUMO = -0.140586462181682
cycle= 97 E= -106.897488917172  delta_E= -1.14e-13  |g|= 0.00219  |ddm|= 2.69e-14
  HOMO = -0.519324502360768  LUMO = -0.140586462181685
cycle= 98 E= -106.897488917172  delta_E= 7.11e-14  |g|= 0.00219  |ddm|= 5.35e-14
  HOMO = -0.519324502360768  LUMO = -0.140586462181681
cycle= 99 E= -106.897488917172  delta_E= 1.42e-14  |g|= 0.00219  |ddm|= 2.19e-14
  HOMO = -0.520563616930412  LUMO = -0.140557793346041
cycle= 100 E= -106.897707255334  delta_E= -0.000218  |g|= 0.00191  |ddm|= 0.00281
  HOMO = -0.51948158858215  LUMO = -0.140582831194135
cycle= 101 E= -106.897516973977  delta_E= 0.00019  |g|= 0.00167  |ddm|= 0.00246
  HOMO = -0.519481588582156  LUMO = -0.140582831194136
cycle= 102 E= -106.897516973977  delta_E= -2.84e-14  |g|= 0.00167  |ddm|= 2.69e-14
  HOMO = -0.519481588582176  LUMO = -0.140582831194138
cycle= 103 E= -106.897516973977  delta_E= 8.53e-14  |g|= 0.00167  |ddm|= 5.46e-14
  HOMO = -0.519481588582162  LUMO = -0.140582831194135
cycle= 104 E= -106.897516973977  delta_E= -1.71e-13  |g|= 0.00167  |ddm|= 5.09e-14
  HOMO = -0.519481588582189  LUMO = -0.140582831194134
cycle= 105 E= -106.897516973977  delta_E= 8.53e-14  |g|= 0.00167  |ddm|= 6.8e-14
  HOMO = -0.519481588582149  LUMO = -0.140582831194134
cycle= 106 E= -106.897516973977  delta_E= -9.95e-14  |g|= 0.00167  |ddm|= 8.43e-14
  HOMO = -0.520426244181351  LUMO = -0.140560974738188
cycle= 107 E= -106.897683384993  delta_E= -0.000166  |g|= 0.00146  |ddm|= 0.00215
  HOMO = -0.519601367781757  LUMO = -0.14058006187058
cycle= 108 E= -106.897538293676  delta_E= 0.000145  |g|= 0.00127  |ddm|= 0.00187
  HOMO = -0.519601367781991  LUMO = -0.140580061870573
cycle= 109 E= -106.897538293676  delta_E= -1.42e-14  |g|= 0.00127  |ddm|= 5.31e-13
  HOMO = -0.519601367781999  LUMO = -0.140580061870574
cycle= 110 E= -106.897538293676  delta_E= 5.68e-14  |g|= 0.00127  |ddm|= 2.56e-14
  HOMO = -0.519601367781748  LUMO = -0.140580061870578
cycle= 111 E= -106.897538293676  delta_E= 2.84e-14  |g|= 0.00127  |ddm|= 5.71e-13
  HOMO = -0.519601367781742  LUMO = -0.140580061870579
cycle= 112 E= -106.897538293676  delta_E= -8.53e-14  |g|= 0.00127  |ddm|= 1.3e-14
  HOMO = -0.519601367781857  LUMO = -0.140580061870577
cycle= 113 E= -106.897538293676  delta_E= -1.42e-14  |g|= 0.00127  |ddm|= 2.63e-13
  HOMO = -0.520321535894359  LUMO = -0.14056339914864
cycle= 114 E= -106.897665134476  delta_E= -0.000127  |g|= 0.00111  |ddm|= 0.00164
  HOMO = -0.519692695713556  LUMO = -0.140577949955697
cycle= 115 E= -106.897554506421  delta_E= 0.000111  |g|= 0.000971  |ddm|= 0.00143
  HOMO = -0.519692695713556  LUMO = -0.140577949955698
cycle= 116 E= -106.897554506421  delta_E= 5.68e-14  |g|= 0.000971  |ddm|= 1.53e-14
  HOMO = -0.520241721878187  LUMO = -0.140565246861115
Extra cycle  E= -106.897651190404  delta_E= -9.67e-05  |g|= 0.000848  |ddm|= 0.00125
converged SCF energy = -106.897651190404
**** MO energy ****
MO #1   energy= -26.1964693731848  occ= 2
MO #2   energy= -2.59195342099165  occ= 2
MO #3   energy= -1.43095377117022  occ= 2
MO #4   energy= -0.545719169861736 occ= 2
MO #5   energy= -0.520241721878192 occ= 2
MO #6   energy= -0.520241721878187 occ= 2
MO #7   energy= -0.140565246861115 occ= 0
MO #8   energy= -0.0731770348927149 occ= 0
MO #9   energy= -0.0731770348927108 occ= 0
MO #10  energy= -0.0304400698779433 occ= 0
MO #11  energy= 0.0598032023693354 occ= 0
MO #12  energy= 0.0956621215554127 occ= 0
MO #13  energy= 0.0956621215554284 occ= 0
MO #14  energy= 0.241383198821431  occ= 0
MO #15  energy= 1.6423517622848    occ= 0
MO #16  energy= 1.64235176228481   occ= 0
MO #17  energy= 1.6813293554987    occ= 0
MO #18  energy= 2.13612395847617   occ= 0
 ** Mulliken pop  **
pop of  0 Li 1s        2.00114
pop of  0 Li 2s        0.14070
pop of  0 Li 3s       -0.03477
pop of  0 Li 2px       0.16478
pop of  0 Li 2py       0.16478
pop of  0 Li 2pz       0.11407
pop of  0 Li 3px      -0.00981
pop of  0 Li 3py      -0.00981
pop of  0 Li 3pz       0.02001
pop of  1 F 1s        1.99774
pop of  1 F 2s        0.94372
pop of  1 F 3s        0.96292
pop of  1 F 2px       1.07142
pop of  1 F 2py       1.07142
pop of  1 F 2pz       1.10033
pop of  1 F 3px       0.77361
pop of  1 F 3py       0.77361
pop of  1 F 3pz       0.75413
 ** Mulliken atomic charges  **
charge of  0Li =      0.44890
charge of  1F =     -0.44890
Dipole moment(X, Y, Z, Debye):  0.00000,  0.00000, -5.45724
